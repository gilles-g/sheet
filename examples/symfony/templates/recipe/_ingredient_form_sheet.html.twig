<div class="sheet-wrapper">
    <div class="sheet-header">
        <h2>Add Ingredient to {{ recipe.name }}</h2>
        <button data-action="click->sheet#close" class="btn-close" aria-label="Close"></button>
    </div>
    
    <div class="sheet-scrollpane">
        <div class="sheet-content">
            {{ form_start(form, {
                'attr': {
                    'data-turbo': 'true',
                    'data-turbo-frame': 'recipe-ingredient-form-frame'
                }
            }) }}
            
            <turbo-frame id="recipe-ingredient-form-frame">
                {% if form.vars.errors|length > 0 %}
                    <div class="alert alert-danger">
                        {{ form_errors(form) }}
                    </div>
                {% endif %}
                
                <div class="mb-3">
                    {{ form_row(form.ingredient) }}
                </div>
                
                <div class="mb-3">
                    {{ form_row(form.quantity) }}
                </div>
                
                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-primary">
                        Add Ingredient to Recipe
                    </button>
                    <button type="button" 
                            data-action="click->sheet#close" 
                            class="btn btn-secondary">
                        Cancel
                    </button>
                </div>
            </turbo-frame>
            
            {{ form_end(form) }}
            
            {# This is the key feature: a button at the bottom to create a new ingredient in a nested sheet #}
            <hr class="my-4">
            <div class="text-center">
                <p class="text-muted mb-2">Don't see the ingredient you need?</p>
                <button 
                    data-controller="sheet-opener"
                    data-action="click->sheet-opener#open"
                    data-sheet-opener-url-value="{{ path('ingredient_create_sheet') }}"
                    class="btn btn-outline-primary">
                    <i class="bi bi-plus-circle"></i> Create New Ingredient
                </button>
            </div>
        </div>
    </div>
</div>
